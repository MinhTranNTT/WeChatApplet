(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["mySubPkg-orderManage-orderManage"],{"0aa9":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return r}));var r={emptyArea:n("53e5").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("v-uni-view",{staticClass:"order-status"},t._l(t.orderStatus,(function(e,r){return n("v-uni-view",{key:r,class:r===t.selecetdOrderStatus?"activate":"order-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.orderList(r)}}},[n("v-uni-view",[t._v(t._s(e.text))])],1)})),1),n("v-uni-view",{staticClass:"order-info"},t._l(t.ordersList,(function(e,r){return 0==e.isDelete?n("v-uni-view",{key:r,staticClass:"order-info-item"},[n("v-uni-navigator",{attrs:{url:"/mySubPkg/orderInfo/orderInfo?order_id="+e.sn}},[n("v-uni-view",{staticClass:"order"},[n("v-uni-view",{staticClass:"sn"},[n("v-uni-view",{staticClass:"title"},[t._v("订单号：")]),n("v-uni-view",{staticClass:"value"},[t._v(t._s(e.sn))])],1),0===e.refundStatus?n("v-uni-view",{staticClass:"stat"},[0===e.status?n("v-uni-view",{staticClass:"status"},[t._v("待支付")]):1===e.status?n("v-uni-view",{staticClass:"status"},[t._v("已支付")]):2===e.status?n("v-uni-view",{staticClass:"status"},[t._v("已完成")]):n("v-uni-view",{staticClass:"status"},[t._v("已取消")])],1):1===e.refundStatus?n("v-uni-view",{staticClass:"stat"},[n("v-uni-view",{staticClass:"status",attrs:{id:"refund"}},[t._v("已申请退款")])],1):2===e.refundStatus?n("v-uni-view",{staticClass:"stat"},[n("v-uni-view",{staticClass:"status",attrs:{id:"refund"}},[t._v("退款成功")])],1):t._e()],1),n("v-uni-view",{staticClass:"camp-info"},[n("v-uni-image",{attrs:{src:e.productImage}}),n("v-uni-view",{staticClass:"product-name"},[n("v-uni-view",[t._v(t._s(e.productName))])],1),n("v-uni-view",{staticClass:"product-price"},[n("v-uni-view",{staticClass:"price"},[t._v("￥"+t._s(Number((e.originalPrice/100).toFixed(2))))]),n("v-uni-view",{staticClass:"num"},[t._v("x"+t._s(e.productCount))])],1)],1),n("v-uni-view",{staticClass:"total-price"},[n("v-uni-view",{staticClass:"text"},[t._v("总付款金额:")]),n("v-uni-view",{staticClass:"t-price"},[t._v("￥"+t._s(Number((e.payPrice/100).toFixed(2))))])],1)],1),0===e.refundStatus?n("v-uni-view",[0==e.status?n("v-uni-view",{staticClass:"options"},[n("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("dateFormat")(e.createTime,"YYYY-MM-DD HH:mm:ss")))]),n("v-uni-button",{attrs:{id:"one",type:"default",plain:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancleOrder(r)}}},[t._v("取消订单")]),n("v-uni-button",{attrs:{id:"two",type:"default",plain:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.payOrder(r)}}},[t._v("去付款")])],1):1==e.status?n("v-uni-view",{staticClass:"options"},[n("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("dateFormat")(e.createTime,"YYYY-MM-DD HH:mm:ss")))]),n("v-uni-button",{attrs:{id:"one",type:"default",plain:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteOrder(r)}}},[t._v("删除订单")]),n("v-uni-button",{attrs:{id:"two",type:"default",plain:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.applyRefund(r)}}},[t._v("申请退款")])],1):n("v-uni-view",{staticClass:"options"},[n("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("dateFormat")(e.createTime,"YYYY-MM-DD HH:mm:ss")))]),n("v-uni-button",{attrs:{id:"three",type:"default",plain:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteOrder(r)}}},[t._v("删除订单")])],1),0===e.status?n("v-uni-view",{staticClass:"tips"},[n("v-uni-view",[t._v("订单会保留30分钟，请及时支付")])],1):t._e()],1):1===e.refundStatus?n("v-uni-view",[n("v-uni-view",{staticClass:"options"},[n("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("dateFormat")(e.createTime,"YYYY-MM-DD HH:mm:ss")))]),n("v-uni-button",{attrs:{id:"three",type:"default",plain:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancleApply()}}},[t._v("取消申请")])],1)],1):n("v-uni-view",[n("v-uni-view",{staticClass:"options"},[n("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("dateFormat")(e.createTime,"YYYY-MM-DD HH:mm:ss")))]),n("v-uni-button",{attrs:{id:"three",type:"default",plain:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteOrder(r)}}},[t._v("删除订单")])],1)],1)],1):t._e()})),1),n("empty-area")],1)},a=[]},"29c7":function(t,e,n){"use strict";n.r(e);var r=n("9e6a"),i=n.n(r);for(var a in r)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e["default"]=i.a},"33a2":function(t,e,n){var r=n("a740");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var i=n("4f06").default;i("64c0559d",r,!0,{sourceMap:!1,shadowMode:!1})},"53e5":function(t,e,n){"use strict";n.r(e);var r=n("d56f"),i=n("29c7");for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("83c8");var o=n("f0c5"),s=Object(o["a"])(i["default"],r["b"],r["c"],!1,null,"83544afa",null,!1,r["a"],void 0);e["default"]=s.exports},6720:function(t,e,n){"use strict";n.r(e);var r=n("d16a"),i=n.n(r);for(var a in r)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e["default"]=i.a},"83c8":function(t,e,n){"use strict";var r=n("33a2"),i=n.n(r);i.a},"9e6a":function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={name:"empty-area",data:function(){return{}}}},a740:function(t,e,n){var r=n("24fb");e=r(!1),e.push([t.i,'@charset "UTF-8";\n/* 水平间距 */\n/* 水平间距 */.empty[data-v-83544afa]{height:%?150?%}',""]),t.exports=e},b85c:function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=(0,r.default)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(u)throw o}}}},n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("d9e2"),n("d401");var r=function(t){return t&&t.__esModule?t:{default:t}}(n("06c5"))},d16a:function(t,e,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("d3b7"),n("ddb0"),n("4de4"),n("2ca0"),n("14d9");var i=r(n("c7eb")),a=r(n("b85c")),o=r(n("1da1")),s={data:function(){return{orderStatus:[{id:4,text:"全部"},{id:0,text:"待付款"},{id:1,text:"已付款"},{id:2,text:"已完成"},{id:3,text:"已取消"}],ordersList:[],selecetdOrderStatus:0}},onLoad:function(){this.getAllOrder(),this.getAllUnPaidOrder()},onReady:function(){},methods:{getAllUnPaidOrder:function(){return(0,o.default)((0,i.default)().mark((function t(){var e,n,r,o,s,u,d;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,uni.getStorageInfoSync().keys;case 2:e=t.sent,n=e.filter((function(t){return t.startsWith("order")})),r={},o=(0,a.default)(n),t.prev=6,o.s();case 8:if((s=o.n()).done){t.next=19;break}return u=s.value,t.next=12,uni.getStorageSync(u);case 12:if(d=t.sent,!((new Date).getTime()>d.expirationTime)){t.next=16;break}return t.next=16,uni.removeStorageSync(u);case 16:r[u]=d;case 17:t.next=8;break;case 19:t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](6),o.e(t.t0);case 24:return t.prev=24,o.f(),t.finish(24);case 27:case"end":return t.stop()}}),t,null,[[6,21,24,27]])})))()},getAllOrder:function(){var t=this;return(0,o.default)((0,i.default)().mark((function e(){var n,r,a;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t,e.next=3,uni.$http.get("/user/order/getList");case 3:return r=e.sent,a=r.data,n.ordersList=a.data,e.next=8,uni.setStorageSync("orderList",a.data);case 8:case"end":return e.stop()}}),e)})))()},orderList:function(t){var e=this;return(0,o.default)((0,i.default)().mark((function n(){var r,a,o;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e,0===t)r.ordersList=uni.getStorageSync("orderList");else for(r.ordersList=[],a=uni.getStorageSync("orderList"),o=0;o<a.length;o++)a[o].status===r.orderStatus[t].id&&r.ordersList.push(a[o]);r.selecetdOrderStatus=t;case 3:case"end":return n.stop()}}),n)})))()},getMinusAndSecond:function(t){var e=(new Date).getTime();if(t>e){var n=t-e,r=Math.floor(n/6e4),i=Math.floor(n%6e4/1e3);return[r,i]}return[0,0]},cancleOrder:function(t){var e=this;return(0,o.default)((0,i.default)().mark((function n(){var r,a;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e,a=r.ordersList[t],n.next=4,uni.$http.put("/user/order/cancel",a);case 4:uni.redirectTo({url:"/mySubPkg/orderManage/orderManage"});case 5:case"end":return n.stop()}}),n)})))()},deleteOrder:function(t){var e=this;return(0,o.default)((0,i.default)().mark((function n(){var r,a;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e,a=r.ordersList[t],n.next=4,uni.$http.put("/user/order/delete",a);case 4:uni.redirectTo({url:"/mySubPkg/orderManage/orderManage"});case 5:case"end":return n.stop()}}),n)})))()},payOrder:function(t){var e=this;return(0,o.default)((0,i.default)().mark((function n(){var r,a,o,s;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e,a=r.ordersList[t],o=a.sn,console.log(o),n.next=6,uni.getStorageSync("order"+o);case 6:if(s=n.sent,!((new Date).getTime()>s.expirationTime)){n.next=10;break}return uni.showToast({title:"订单已过期,请刷新重试",icon:"none",mask:!0}),n.abrupt("return");case 10:return console.log(s),n.next=13,uni.requestPayment({appId:s.data.appId,nonceStr:s.data.nonceStr,package:s.data.package,paySign:s.data.paySign,signType:s.data.signType,timeStamp:s.data.timeStamp,success:function(t){uni.$showMsg("支付成功"),uni.removeStorageSync("order"+s.data.sn),uni.redirectTo({url:"/mySubPkg/orderManage/orderManage"})},fail:function(t){uni.$showMsg("取消支付"),uni.redirectTo({url:"/mySubPkg/orderManage/orderManage"})}});case 13:case"end":return n.stop()}}),n)})))()},applyRefund:function(t){var e=this;return(0,o.default)((0,i.default)().mark((function n(){var r,a;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e,a=r.ordersList[t],n.next=4,uni.$http.post("/user/wxRefund/refund",a);case 4:uni.$showMsg("已申请退款");case 5:case"end":return n.stop()}}),n)})))()},cancleApply:function(t){}}};e.default=s},d56f:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var r=function(){var t=this.$createElement,e=this._self._c||t;return e("v-uni-view",[e("v-uni-view",{staticClass:"empty"})],1)},i=[]},dc81:function(t,e,n){var r=n("f471");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var i=n("4f06").default;i("48cc328d",r,!0,{sourceMap:!1,shadowMode:!1})},de9a:function(t,e,n){"use strict";var r=n("dc81"),i=n.n(r);i.a},df4d:function(t,e,n){"use strict";n.r(e);var r=n("0aa9"),i=n("6720");for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("de9a");var o=n("f0c5"),s=Object(o["a"])(i["default"],r["b"],r["c"],!1,null,"376f6f80",null,!1,r["a"],void 0);e["default"]=s.exports},f471:function(t,e,n){var r=n("24fb");e=r(!1),e.push([t.i,'@charset "UTF-8";\n/* 水平间距 */\n/* 水平间距 */uni-page-body[data-v-376f6f80]{background-color:#ccc}body.?%PAGE?%[data-v-376f6f80]{background-color:#ccc}.order-status[data-v-376f6f80]{display:flex;flex-direction:row;justify-content:center;align-items:center;width:100%;background-color:#fff}.order-status .order-item[data-v-376f6f80]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:20%;height:%?80?%;color:#7f7f7f}.order-status .activate[data-v-376f6f80]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:20%;height:%?80?%;color:#0eb117;border-bottom:#0eb117 solid %?4?%}.order-info[data-v-376f6f80]{display:flex;flex-direction:column;justify-content:center;width:%?704?%;margin:%?30?% %?23?% 0 %?23?%}.order-info .order-info-item[data-v-376f6f80]{display:flex;flex-direction:column;justify-content:center;background-color:#fff;border-radius:%?30?%;margin:%?10?% 0 %?10?% 0}.order-info .order-info-item .order[data-v-376f6f80]{display:flex;flex-direction:row;margin:%?10?% %?20?% %?10?% %?20?%}.order-info .order-info-item .order .sn[data-v-376f6f80]{display:flex;flex-direction:row;font-size:%?25?%;color:#999}.order-info .order-info-item .order .stat[data-v-376f6f80]{margin:0 0 0 auto}.order-info .order-info-item .order .stat .status[data-v-376f6f80]{color:red;font-weight:700}.order-info .order-info-item .order .stat #refund[data-v-376f6f80]{color:#0eb117}.order-info .order-info-item .camp-info[data-v-376f6f80]{display:flex;flex-direction:row;margin:%?10?% %?20?% %?10?% %?20?%;align-items:center}.order-info .order-info-item .camp-info uni-image[data-v-376f6f80]{width:%?170?%;height:%?170?%;margin-right:%?10?%;border-radius:%?20?%}.order-info .order-info-item .camp-info .product-name[data-v-376f6f80]{width:%?370?%;font-size:%?28?%}.order-info .order-info-item .camp-info .product-price[data-v-376f6f80]{margin:0 0 0 auto;display:flex;flex-direction:column;align-items:flex-end}.order-info .order-info-item .camp-info .product-price .price[data-v-376f6f80]{font-size:%?35?%;color:#ff0035}.order-info .order-info-item .camp-info .product-price .num[data-v-376f6f80]{font-size:%?28?%;color:#999;margin:%?10?% %?10?% 0 0}.order-info .order-info-item .total-price[data-v-376f6f80]{display:flex;flex-direction:row;align-items:center;margin:%?5?% 0 %?10?% %?20?%}.order-info .order-info-item .total-price .text[data-v-376f6f80]{font-size:%?28?%}.order-info .order-info-item .total-price .t-price[data-v-376f6f80]{margin:0 %?20?% 0 auto;font-size:%?28?%;color:#ff0035}.order-info .options[data-v-376f6f80]{display:flex;flex-direction:row;justify-content:flex-end;align-items:center;margin:%?10?% 0 %?20?% 0}.order-info .options #one[data-v-376f6f80]{margin:0 %?30?% 0 auto}.order-info .options #two[data-v-376f6f80]{margin:0 %?20?% 0 %?0?%}.order-info .options #three[data-v-376f6f80]{margin:0 %?20?% 0 auto}.order-info .options .time[data-v-376f6f80]{margin:0 auto 0 %?20?%;font-size:%?28?%;color:#999}.order-info .options uni-button[data-v-376f6f80]{display:flex;flex-direction:row;border:#999 solid 1px;font-size:%?25?%;font-weight:700}.order-info .tips[data-v-376f6f80]{display:flex;flex-direction:row;justify-content:center;font-size:%?25?%;color:#ff0035}',""]),t.exports=e}}]);